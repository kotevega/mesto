(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e.baseUrl,this._headers=e.headers}var n,r;return n=t,(r=[{key:"_checkResponse",value:function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}},{key:"getInitialCardsApi",value:function(){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return t._checkResponse(e)}))}},{key:"postNewCardApi",value:function(t,e){var n=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:e})}).then((function(t){return n._checkResponse(t)}))}},{key:"getUserInfoFromApi",value:function(){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then((function(e){return t._checkResponse(e)}))}},{key:"patchUserInfoToApi",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.name,about:t.about})}).then((function(t){return e._checkResponse(t)}))}},{key:"patchUserAvatarToApi",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})}).then((function(t){return e._checkResponse(t)}))}},{key:"deleteCardFromApi",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"putCardLikeToApi",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"deleteCardLikeFromApi",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function t(e){var n=e.data,r=e.userId,o=e.templateSelector,i=e.handleClickDeleteButton,u=e.handleCardClick,a=e.handleLikeButtonClick,c=e.handleLikeDelete;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._dataCard=n,this._name=n.name,this._imageLink=n.link,this._idCard=n._id,this._likes=n.likes,this._ownerId=n.owner._id,this._userId=r,this._selector=o,this._handleClickDeleteButton=i,this._handleCardClick=u,this._handleLikeButton=a,this._handleLikeDelete=c}var e,n;return e=t,(n=[{key:"_getElement",value:function(){return document.querySelector(this._selector).content.querySelector(".element__list").cloneNode(!0)}},{key:"createCard",value:function(){return this._element=this._getElement(),this._elementCaption=this._element.querySelector(".element__caption"),this._elementImage=this._element.querySelector(".element__image"),this._likeCardButton=this._element.querySelector(".element__like-button"),this._buttonDeleteCard=this._element.querySelector(".element__delete-button"),this._popupOpenImage=this._element.querySelector(".element__button-image"),this._elementLikeCounter=this._element.querySelector(".element__counter"),this._elementCaption.textContent=this._name,this._elementImage.src=this._imageLink,this._elementImage.alt=this._name,this._ownerId!==this._userId&&this._buttonDeleteCard.remove(),this.countLikes(this._dataCard),this._setEventListeners(),this._element}},{key:"_handleLikeButtonClick",value:function(t){this._checkLikes()?this._handleLikeDelete(t):this._handleLikeButton(t)}},{key:"_setEventListeners",value:function(){var t=this;this._likeCardButton.addEventListener("click",(function(){return t._handleLikeButtonClick(t._idCard)})),this._popupOpenImage.addEventListener("click",(function(){return t._handleCardClick(t._name,t._imageLink)})),this._buttonDeleteCard.addEventListener("click",(function(){return t._handleClickDeleteButton(t._idCard,t._element)}))}},{key:"_checkLikes",value:function(){var t=this;return this._likes.some((function(e){return e._id===t._userId}))}},{key:"countLikes",value:function(t){this._likes=t.likes,0===this._likes.length?this._elementLikeCounter.textContent="0":this._elementLikeCounter.textContent=this._likes.length,this._checkLikes()?this._likeCardButton.classList.add("element__like-button_active"):this._likeCardButton.classList.remove("element__like-button_active")}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}var c=function(){function t(e,n){var r=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderer=r,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(t,e){var n=this;t.reverse().forEach((function(t){return n._renderer(t,e)}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===l(o)?o:String(o)),r)}var o}var f=function(){function t(e){var n=e.nameSelector,r=e.jobSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._nameSelector=document.querySelector(n),this._jobSelector=document.querySelector(r),this._avatarSelector=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return this._userData={},this._userData.name=this._nameSelector.textContent,this._userData.about=this._jobSelector.textContent,this._userData}},{key:"setUserInfo",value:function(t){t.name&&(this._nameSelector.textContent=null==t?void 0:t.name),t.about&&(this._jobSelector.textContent=null==t?void 0:t.about)}},{key:"setUserAvatar",value:function(t){t.avatar&&(this._avatarSelector.src=null==t?void 0:t.avatar)}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function y(t){var e=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===p(e)?e:String(e)}var m=function(){function t(e){var n,r,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(t){"Escape"===t.code&&i.close()},(r=y(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popupSelector=e,this._popup=document.querySelector(this._popupSelector),this._buttonSubmit=this._popup.querySelector(".popup__submit-button")}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"renderLoader",value:function(t,e){t?(this.defaulText=this._buttonSubmit.textContent,this._buttonSubmit.textContent=e):this._buttonSubmit.textContent=this.defaulText}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("mousedown",(function(e){e.target.classList.contains("popup_opened")&&t.close(),e.target.classList.contains("popup__close-button")&&t.close()}))}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===d(o)?o:String(o)),r)}var o}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},v.apply(this,arguments)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=S(r);if(o){var n=S(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e,n=t.popupSelector,r=t.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,n))._handleFormSubmit=r,e._form=e._popup.querySelector(".popup__form"),e}return e=u,(n=[{key:"_getInputValues",value:function(){var t=this;return this._inputList=this._popup.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((function(e){t._formValues[e.name]=e.value})),this._formValues}},{key:"setEventListeners",value:function(){var t=this;v(S(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())}))}},{key:"close",value:function(){v(S(u.prototype),"close",this).call(this),this._form.reset()}}])&&b(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},E.apply(this,arguments)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=j(r);if(o){var n=j(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._image=e._popup.querySelector(".popup__image"),e._heading=e._popup.querySelector(".popup__heading"),e}return e=u,(n=[{key:"open",value:function(t,e){E(j(u.prototype),"open",this).call(this),this._image.src=e,this._image.alt=t,this._heading.textContent=t}}])&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==O(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===O(o)?o:String(o)),r)}var o}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},T.apply(this,arguments)}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=B(r);if(o){var n=B(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e,n=t.popupSelector,r=t.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,n))._handleFormSubmit=r,e._buttonSubmit=e._popup.querySelector(".popup__submit-button"),e}return e=u,(n=[{key:"open",value:function(t,e){T(B(u.prototype),"open",this).call(this),this.id=t,this.card=e}},{key:"setEventListeners",value:function(){var t=this;T(B(u.prototype),"setEventListeners",this).call(this),this._buttonSubmit.addEventListener("click",(function(e){e.preventDefault(),t._handleFormSubmit(t.id,t.card)}))}}])&&P(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==A(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===A(o)?o:String(o)),r)}var o}var x=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._form=e,this._inputElement=n.inputElement,this._inputErrorClass=n.inputErrorClass,this._errorClass=n.errorClass,this._inputVisibleError=n.inputVisibleError,this._inactiveButtonClass=n.inactiveButtonClass,this._inputList=Array.from(this._form.querySelectorAll(n.inputElement)),this._submitButton=this._form.querySelector(n.submitButtonSelector)}var e,n;return e=t,(n=[{key:"resetValidation",value:function(){var t=this;this._inputList.forEach((function(e){t._hideInputError(e)}))}},{key:"_showInputError",value:function(t){this._errorTextElement=this._form.querySelector("".concat(this._inputErrorClass).concat(t.name)),this._errorTextElement.textContent=t.validationMessage,this._errorTextElement.classList.add(this._errorClass),t.classList.add(this._inputVisibleError)}},{key:"_hideInputError",value:function(t){this._errorTextElement=this._form.querySelector("".concat(this._inputErrorClass).concat(t.name)),this._errorTextElement.textContent="",this._errorTextElement.classList.remove(this._errorClass),t.classList.remove(this._inputVisibleError)}},{key:"_enableButton",value:function(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}},{key:"disableButton",value:function(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_hasInvalidInput",value:function(){return Array.from(this._inputList).some((function(t){return!t.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?this.disableButton():this._enableButton()}},{key:"_setEventListener",value:function(){var t=this;this._inputList.forEach((function(e){t._toggleButtonState(),e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListener()}}])&&q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),U={inputElement:".popup__input",inputErrorClass:".popup__input-error_type_",errorClass:"popup__input-error",inputVisibleError:"popup__input_visible-error",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled"};function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var V,F=document.forms.popup_form_user,N=document.forms.popup_form_avatar,J=document.forms.popup_form_place,z=document.querySelector(".profile__edit-button"),G=document.querySelector(".profile__edit-avatar"),H=document.querySelector(".profile__add-button"),M=document.querySelector("#popup-name"),$=document.querySelector("#popup-about"),K=new x(N,U),Q=new x(J,U),W=new x(F,U),X=new n({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-65",headers:{authorization:"efafdb7e-dc8f-4c7a-ad89-5ae9b99df990","Content-Type":"application/json"}});Promise.all([X.getUserInfoFromApi(),X.getInitialCardsApi()]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];V=o._id,tt.setUserInfo(o),tt.setUserAvatar(o),Z.renderItems(i,V)})).catch((function(t){return console.log("Ошибка: ".concat(t))}));var Y=function(t,e){var n=new i({data:t,userId:e,templateSelector:".element-template",handleClickDeleteButton:function(t,e){ot.open(t,e)},handleCardClick:function(t,e){it.open(t,e)},handleLikeButtonClick:function(t){X.putCardLikeToApi(t).then((function(t){n.countLikes(t)})).catch((function(t){return console.log("Ошибка: ".concat(t))}))},handleLikeDelete:function(t){X.deleteCardLikeFromApi(t).then((function(t){n.countLikes(t)})).catch((function(t){return console.log("Ошибка: ".concat(t))}))}});return n.createCard()},Z=new c({renderer:function(t,e){Z.addItem(Y(t,e))}},".element"),tt=new f({nameSelector:".profile__name",jobSelector:".profile__occupation",avatarSelector:".profile__avatar"}),et=new k({popupSelector:".popup_type-avatar",handleFormSubmit:function(t){et.renderLoader(!0,"Сохранение..."),X.patchUserAvatarToApi(t).then((function(t){tt.setUserAvatar(t),et.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){et.renderLoader(!1)}))}}),nt=new k({popupSelector:".popup_type-user",handleFormSubmit:function(t){nt.renderLoader(!0,"Сохранение..."),X.patchUserInfoToApi(t).then((function(t){tt.setUserInfo(t),nt.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){nt.renderLoader(!1)}))}}),rt=new k({popupSelector:".popup_type-place",handleFormSubmit:function(t){rt.renderLoader(!0,"Сохранение..."),X.postNewCardApi(t.imageName,t.imageLink).then((function(t){Z.addItem(Y(t,V)),rt.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){rt.renderLoader(!1)}))}}),ot=new R({popupSelector:".popup_type-accept",handleFormSubmit:function(t,e){ot.renderLoader(!0,"Сохранение..."),X.deleteCardFromApi(t).then((function(){e.remove(),e=null,ot.close()})).catch((function(t){return console.log("Ошибка: ".concat(t))})).finally((function(){ot.renderLoader(!1)}))}}),it=new L(".popup_type-zoom");K.enableValidation(),W.enableValidation(),Q.enableValidation(),et.setEventListeners(),nt.setEventListeners(),it.setEventListeners(),rt.setEventListeners(),ot.setEventListeners(),G.addEventListener("click",(function(){et.open(),K.resetValidation(),K.disableButton()})),z.addEventListener("click",(function(){nt.open(),M.value=tt.getUserInfo().name,$.value=tt.getUserInfo().about,W.resetValidation(),W.disableButton()})),H.addEventListener("click",(function(){rt.open(),Q.resetValidation(),Q.disableButton()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGtCQUNwQjVDLEVBQW9CaEIsZUFDdEIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzQXBpKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBwb3N0TmV3Q2FyZEFwaShuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvRnJvbUFwaSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcGF0Y2hVc2VySW5mb1RvQXBpKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcGF0Y2hVc2VyQXZhdGFyVG9BcGkoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmRGcm9tQXBpKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcHV0Q2FyZExpa2VUb0FwaShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmRMaWtlRnJvbUFwaShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHtcclxuICAgIGRhdGEsXHJcbiAgICB1c2VySWQsXHJcbiAgICB0ZW1wbGF0ZVNlbGVjdG9yLFxyXG4gICAgaGFuZGxlQ2xpY2tEZWxldGVCdXR0b24sXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlRGVsZXRlLFxyXG4gIH0pIHtcclxuICAgIHRoaXMuX2RhdGFDYXJkID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZUxpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZENhcmQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX3NlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNsaWNrRGVsZXRlQnV0dG9uID0gaGFuZGxlQ2xpY2tEZWxldGVCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbkNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZURlbGV0ZSA9IGhhbmRsZUxpa2VEZWxldGU7XHJcbiAgfVxyXG5cclxuICBfZ2V0RWxlbWVudCgpIHtcclxuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saXN0XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xyXG4gICAgdGhpcy5fZWxlbWVudENhcHRpb24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fY2FwdGlvblwiKTtcclxuICAgIHRoaXMuX2VsZW1lbnRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2xpa2VDYXJkQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fYnV0dG9uRGVsZXRlQ2FyZCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuZWxlbWVudF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcG9wdXBPcGVuSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmVsZW1lbnRfX2J1dHRvbi1pbWFnZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fZWxlbWVudExpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2NvdW50ZXJcIik7XHJcbiAgICB0aGlzLl9lbGVtZW50Q2FwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9lbGVtZW50SW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2VMaW5rO1xyXG4gICAgdGhpcy5fZWxlbWVudEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgaWYgKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9idXR0b25EZWxldGVDYXJkLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY291bnRMaWtlcyh0aGlzLl9kYXRhQ2FyZCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VCdXR0b25DbGljayhjYXJkKSB7XHJcbiAgICBpZiAodGhpcy5fY2hlY2tMaWtlcygpKSB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VEZWxldGUoY2FyZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKGNhcmQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayh0aGlzLl9pZENhcmQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcG9wdXBPcGVuSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9pbWFnZUxpbmspXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tEZWxldGVCdXR0b24odGhpcy5faWRDYXJkLCB0aGlzLl9lbGVtZW50KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0xpa2VzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGl0ZW0pID0+IGl0ZW0uX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgY291bnRMaWtlcyhkYXRhQ2FyZCkge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhQ2FyZC5saWtlcztcclxuICAgIGlmICh0aGlzLl9saWtlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhpcy5fZWxlbWVudExpa2VDb3VudGVyLnRleHRDb250ZW50ID0gXCIwXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbGVtZW50TGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5fY2hlY2tMaWtlcygpKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VDYXJkQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBzZWxlY3RvckNhcmQpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yQ2FyZCk7XHJcbiAgfVxyXG4gIFxyXG4gIHJlbmRlckl0ZW1zKGRhdGEsIHVzZXIpIHtcclxuICAgIGRhdGEucmV2ZXJzZSgpLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0sIHVzZXIpKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbUh0bWwpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW1IdG1sKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYlNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICB0aGlzLl91c2VyRGF0YSA9IHt9O1xyXG4gICAgdGhpcy5fdXNlckRhdGEubmFtZSA9IHRoaXMuX25hbWVTZWxlY3Rvci50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX3VzZXJEYXRhLmFib3V0ID0gdGhpcy5fam9iU2VsZWN0b3IudGV4dENvbnRlbnQ7XHJcbiAgICByZXR1cm4gdGhpcy5fdXNlckRhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhmb3JtRGF0YSkge1xyXG4gICAgaWYgKGZvcm1EYXRhLm5hbWUpIHtcclxuICAgICAgdGhpcy5fbmFtZVNlbGVjdG9yLnRleHRDb250ZW50ID0gZm9ybURhdGE/Lm5hbWU7XHJcbiAgICB9XHJcbiAgICBpZiAoZm9ybURhdGEuYWJvdXQpIHtcclxuICAgICAgdGhpcy5fam9iU2VsZWN0b3IudGV4dENvbnRlbnQgPSBmb3JtRGF0YT8uYWJvdXQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGZvcm1EYXRhKSB7XHJcbiAgICBpZiAoZm9ybURhdGEuYXZhdGFyKSB7XHJcbiAgICAgIHRoaXMuX2F2YXRhclNlbGVjdG9yLnNyYyA9IGZvcm1EYXRhPy5hdmF0YXI7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fcG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9idXR0b25TdWJtaXQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmNvZGUgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJlbmRlckxvYWRlcihsb2FkaW5nLCBkaXNwbGF5VGV4dCkge1xyXG4gICAgaWYgKGxvYWRpbmcpIHtcclxuICAgICAgdGhpcy5kZWZhdWxUZXh0ID0gdGhpcy5fYnV0dG9uU3VibWl0LnRleHRDb250ZW50O1xyXG4gICAgICB0aGlzLl9idXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSBkaXNwbGF5VGV4dDtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uU3VibWl0LnRleHRDb250ZW50ID0gdGhpcy5kZWZhdWxUZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZS1idXR0b25cIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9oZWFkaW5nID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faGVhZGluZ1wiKTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9oZWFkaW5nLnRleHRDb250ZW50ID0gbmFtZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGlkQ2FyZCwgY2FyZCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5pZCA9IGlkQ2FyZDtcclxuICAgIHRoaXMuY2FyZCA9IGNhcmQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9idXR0b25TdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5pZCwgdGhpcy5jYXJkKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZm9ybSwgY29uZmlnKSB7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudCA9IGNvbmZpZy5pbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRWaXNpYmxlRXJyb3IgPSBjb25maWcuaW5wdXRWaXNpYmxlRXJyb3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRFbGVtZW50KSk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgdGhpcy5fZXJyb3JUZXh0RWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCR7dGhpcy5faW5wdXRFcnJvckNsYXNzfSR7aW5wdXQubmFtZX1gXHJcbiAgICApO1xyXG4gICAgdGhpcy5fZXJyb3JUZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JUZXh0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dFZpc2libGVFcnJvcik7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXQpIHtcclxuICAgIHRoaXMuX2Vycm9yVGV4dEVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAke3RoaXMuX2lucHV0RXJyb3JDbGFzc30ke2lucHV0Lm5hbWV9YFxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Vycm9yVGV4dEVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgdGhpcy5fZXJyb3JUZXh0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dFZpc2libGVFcnJvcik7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dExpc3QpLnNvbWUoXHJcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAoIXRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcigpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVyKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgaW5wdXRFbGVtZW50OiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiLnBvcHVwX19pbnB1dC1lcnJvcl90eXBlX1wiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yXCIsXHJcbiAgaW5wdXRWaXNpYmxlRXJyb3I6IFwicG9wdXBfX2lucHV0X3Zpc2libGUtZXJyb3JcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbn07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoQ29uZmlybWF0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNvbnN0IGZvcm1FbGVtZW50VXNlciA9IGRvY3VtZW50LmZvcm1zW1wicG9wdXBfZm9ybV91c2VyXCJdO1xyXG5jb25zdCBmb3JtQXZhdGFyID0gZG9jdW1lbnQuZm9ybXNbXCJwb3B1cF9mb3JtX2F2YXRhclwiXTtcclxuY29uc3QgZm9ybVBsYWNlID0gZG9jdW1lbnQuZm9ybXNbXCJwb3B1cF9mb3JtX3BsYWNlXCJdO1xyXG5cclxuY29uc3QgYnV0dG9uRWRpdFB0b2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBidXR0b25FZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWF2YXRhclwiKTtcclxuY29uc3QgYnV0dG9uRWRpdFBsYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgcG9wdXBOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW5hbWVcIik7XHJcbmNvbnN0IHBvcHVwSm9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWFib3V0XCIpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQXZhdGFyLCBjb25maWcpO1xyXG5jb25zdCBwbGFjZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVBsYWNlLCBjb25maWcpO1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudFVzZXIsIGNvbmZpZyk7XHJcbmxldCB1c2VyTm93SWQ7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjVcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImVmYWZkYjdlLWRjOGYtNGM3YS1hZDg5LTVhZTliOTlkZjk5MFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvRnJvbUFwaSgpLCBhcGkuZ2V0SW5pdGlhbENhcmRzQXBpKCldKVxyXG4gIC50aGVuKChbcmVzcG9uc2VVc2VyLCByZXNwb25zZUNhcmRdKSA9PiB7XHJcbiAgICB1c2VyTm93SWQgPSByZXNwb25zZVVzZXIuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzcG9uc2VVc2VyKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzcG9uc2VVc2VyKTtcclxuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMocmVzcG9uc2VDYXJkLCB1c2VyTm93SWQpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApKTtcclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSwgdXNlcikgPT4ge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICBkYXRhOiBkYXRhLFxyXG4gICAgdXNlcklkOiB1c2VyLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcjogXCIuZWxlbWVudC10ZW1wbGF0ZVwiLFxyXG5cclxuICAgIGhhbmRsZUNsaWNrRGVsZXRlQnV0dG9uOiAoaWQsIGNhcmQpID0+IHtcclxuICAgICAgcG9wdXBEZWxldGVBY2NlcHQub3BlbihpZCwgY2FyZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhhbmRsZUNhcmRDbGljazogKG5hbWUsIGxpbmspID0+IHtcclxuICAgICAgcG9wdXBJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgfSxcclxuXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uQ2xpY2s6IChjYXJkSWQpID0+IHtcclxuICAgICAgYXBpXHJcbiAgICAgICAgLnB1dENhcmRMaWtlVG9BcGkoY2FyZElkKVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIG5ld0NhcmQuY291bnRMaWtlcyhyZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGFuZGxlTGlrZURlbGV0ZTogKGNhcmRJZCkgPT4ge1xyXG4gICAgICBhcGlcclxuICAgICAgICAuZGVsZXRlQ2FyZExpa2VGcm9tQXBpKGNhcmRJZClcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBuZXdDYXJkLmNvdW50TGlrZXMocmVzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKSk7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIHJldHVybiBuZXdDYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuXHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW1zLCB1c2VySWQpID0+IHtcclxuICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoaXRlbXMsIHVzZXJJZCkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmVsZW1lbnRcIlxyXG4pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19vY2N1cGF0aW9uXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwX3R5cGUtYXZhdGFyXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcclxuICAgIHBvcHVwQXZhdGFyLnJlbmRlckxvYWRlcih0cnVlLCBcItCh0L7RhdGA0LDQvdC10L3QuNC1Li4uXCIpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5wYXRjaFVzZXJBdmF0YXJUb0FwaShkYXRhKVxyXG4gICAgICAudGhlbigocmVzVXNlcikgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzVXNlcik7XHJcbiAgICAgICAgcG9wdXBBdmF0YXIuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgcG9wdXBBdmF0YXIucmVuZGVyTG9hZGVyKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBwb3B1cFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIucG9wdXBfdHlwZS11c2VyXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGZvcm1EYXRhKSA9PiB7XHJcbiAgICBwb3B1cFByb2ZpbGUucmVuZGVyTG9hZGVyKHRydWUsIFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIik7XHJcbiAgICBhcGlcclxuICAgICAgLnBhdGNoVXNlckluZm9Ub0FwaShmb3JtRGF0YSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgICAgcG9wdXBQcm9maWxlLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIHBvcHVwUHJvZmlsZS5yZW5kZXJMb2FkZXIoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwUGxhY2UgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIucG9wdXBfdHlwZS1wbGFjZVwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChmb3JtRGF0YSkgPT4ge1xyXG4gICAgcG9wdXBQbGFjZS5yZW5kZXJMb2FkZXIodHJ1ZSwgXCLQodC+0YXRgNCw0L3QtdC90LjQtS4uLlwiKTtcclxuICAgIGFwaVxyXG4gICAgICAucG9zdE5ld0NhcmRBcGkoZm9ybURhdGEuaW1hZ2VOYW1lLCBmb3JtRGF0YS5pbWFnZUxpbmspXHJcbiAgICAgIC50aGVuKChuZXdDYXJkRnJvbVBvcHVwKSA9PiB7XHJcbiAgICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQobmV3Q2FyZEZyb21Qb3B1cCwgdXNlck5vd0lkKSk7XHJcbiAgICAgICAgcG9wdXBQbGFjZS5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCkpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwb3B1cFBsYWNlLnJlbmRlckxvYWRlcihmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBEZWxldGVBY2NlcHQgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIi5wb3B1cF90eXBlLWFjY2VwdFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpZCwgY2FyZCkgPT4ge1xyXG4gICAgcG9wdXBEZWxldGVBY2NlcHQucmVuZGVyTG9hZGVyKHRydWUsIFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIik7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmRGcm9tQXBpKGlkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5yZW1vdmUoKTtcclxuICAgICAgICBjYXJkID0gbnVsbDtcclxuICAgICAgICBwb3B1cERlbGV0ZUFjY2VwdC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCkpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwb3B1cERlbGV0ZUFjY2VwdC5yZW5kZXJMb2FkZXIoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZS16b29tXCIpO1xyXG5cclxuYXZhdGFyRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wbGFjZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbnBvcHVwQXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwUHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwUGxhY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBEZWxldGVBY2NlcHQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmJ1dHRvbkVkaXRBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cEF2YXRhci5vcGVuKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRpb24uZGlzYWJsZUJ1dHRvbigpO1xyXG59KTtcclxuXHJcbmJ1dHRvbkVkaXRQdG9maWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcG9wdXBQcm9maWxlLm9wZW4oKTtcclxuICBwb3B1cE5hbWVJbnB1dC52YWx1ZSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCkubmFtZTtcclxuICBwb3B1cEpvYklucHV0LnZhbHVlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKS5hYm91dDtcclxuICBwcm9maWxlRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0aW9uLmRpc2FibGVCdXR0b24oKTtcclxufSk7XHJcblxyXG5idXR0b25FZGl0UGxhY2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cFBsYWNlLm9wZW4oKTtcclxuICBwbGFjZUZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHBsYWNlRm9ybVZhbGlkYXRpb24uZGlzYWJsZUJ1dHRvbigpO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbIkFwaSIsIm9wdGlvbnMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwia2V5IiwidmFsdWUiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY29uY2F0Iiwic3RhdHVzIiwiX3RoaXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsIm5hbWUiLCJsaW5rIiwiX3RoaXMyIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJfdGhpczMiLCJkYXRhIiwiX3RoaXM0IiwiYWJvdXQiLCJfdGhpczUiLCJhdmF0YXIiLCJjYXJkSWQiLCJfdGhpczYiLCJfdGhpczciLCJfdGhpczgiLCJDYXJkIiwiX3JlZiIsInVzZXJJZCIsInRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVDbGlja0RlbGV0ZUJ1dHRvbiIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VCdXR0b25DbGljayIsImhhbmRsZUxpa2VEZWxldGUiLCJfZGF0YUNhcmQiLCJfbmFtZSIsIl9pbWFnZUxpbmsiLCJfaWRDYXJkIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJZCIsIl9zZWxlY3RvciIsIl9oYW5kbGVDbGlja0RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlRGVsZXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwiX2dldEVsZW1lbnQiLCJfZWxlbWVudENhcHRpb24iLCJfZWxlbWVudEltYWdlIiwiX2xpa2VDYXJkQnV0dG9uIiwiX2J1dHRvbkRlbGV0ZUNhcmQiLCJfcG9wdXBPcGVuSW1hZ2UiLCJfZWxlbWVudExpa2VDb3VudGVyIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJyZW1vdmUiLCJjb3VudExpa2VzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiY2FyZCIsIl9jaGVja0xpa2VzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJzb21lIiwiaXRlbSIsImRhdGFDYXJkIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwiYWRkIiwiU2VjdGlvbiIsInNlbGVjdG9yQ2FyZCIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInVzZXIiLCJyZXZlcnNlIiwiZm9yRWFjaCIsIml0ZW1IdG1sIiwicHJlcGVuZCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lU2VsZWN0b3IiLCJfam9iU2VsZWN0b3IiLCJfYXZhdGFyU2VsZWN0b3IiLCJfdXNlckRhdGEiLCJmb3JtRGF0YSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImV2dCIsImNvZGUiLCJjbG9zZSIsIl9wb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2J1dHRvblN1Ym1pdCIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJsb2FkaW5nIiwiZGlzcGxheVRleHQiLCJkZWZhdWxUZXh0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiX1BvcHVwIiwiX2luaGVyaXRzIiwiX3N1cGVyIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImNhbGwiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsInByZXZlbnREZWZhdWx0IiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJQb3B1cFdpdGhJbWFnZSIsIl9pbWFnZSIsIl9oZWFkaW5nIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiaWRDYXJkIiwiaWQiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybSIsImNvbmZpZyIsIl9pbnB1dEVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2lucHV0VmlzaWJsZUVycm9yIiwiaW5wdXRWaXNpYmxlRXJyb3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaGlkZUlucHV0RXJyb3IiLCJfZXJyb3JUZXh0RWxlbWVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZGlzYWJsZWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3Nob3dJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVyIiwidXNlck5vd0lkIiwiZm9ybUVsZW1lbnRVc2VyIiwiZm9ybXMiLCJmb3JtQXZhdGFyIiwiZm9ybVBsYWNlIiwiYnV0dG9uRWRpdFB0b2ZpbGUiLCJidXR0b25FZGl0QXZhdGFyIiwiYnV0dG9uRWRpdFBsYWNlIiwicG9wdXBOYW1lSW5wdXQiLCJwb3B1cEpvYklucHV0IiwiYXZhdGFyRm9ybVZhbGlkYXRpb24iLCJwbGFjZUZvcm1WYWxpZGF0aW9uIiwicHJvZmlsZUZvcm1WYWxpZGF0aW9uIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsImFsbCIsImdldFVzZXJJbmZvRnJvbUFwaSIsImdldEluaXRpYWxDYXJkc0FwaSIsIl9yZWYyIiwicmVzcG9uc2VVc2VyIiwicmVzcG9uc2VDYXJkIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJzZWN0aW9uIiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJyZW5kZXJDYXJkIiwibmV3Q2FyZCIsInBvcHVwRGVsZXRlQWNjZXB0Iiwib3BlbiIsInBvcHVwSW1hZ2UiLCJwdXRDYXJkTGlrZVRvQXBpIiwiZGVsZXRlQ2FyZExpa2VGcm9tQXBpIiwiY3JlYXRlQ2FyZCIsIml0ZW1zIiwiYWRkSXRlbSIsInBvcHVwQXZhdGFyIiwicmVuZGVyTG9hZGVyIiwicGF0Y2hVc2VyQXZhdGFyVG9BcGkiLCJyZXNVc2VyIiwiZmluYWxseSIsInBvcHVwUHJvZmlsZSIsInBhdGNoVXNlckluZm9Ub0FwaSIsInBvcHVwUGxhY2UiLCJwb3N0TmV3Q2FyZEFwaSIsImltYWdlTmFtZSIsImltYWdlTGluayIsIm5ld0NhcmRGcm9tUG9wdXAiLCJkZWxldGVDYXJkRnJvbUFwaSIsImVuYWJsZVZhbGlkYXRpb24iLCJzZXRFdmVudExpc3RlbmVycyIsInJlc2V0VmFsaWRhdGlvbiIsImdldFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==